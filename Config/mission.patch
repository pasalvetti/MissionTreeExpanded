@use "builtin:missions";

// modifications to stock missions
:missions {
    #Main_Kerbin_01 {
        * > ContentBranches > OnSubmit {
// unlocks Dress Rehearsal
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_Kerbin_EVAGround;
				MissionOwner: Agency;
			}
		}
    }

	#Main_Kerbin_03 {
        * > ContentBranches > OnSubmit {
// change unlocked mission from Main_MunOrBust_04 to MTE_Main_Mun_Flyby
            * > ActivateMissionAction {
                @if $$TargetMissionID == Main_MunOrBust_04 {
                    TargetMissionID: MTE_Main_Mun_Flyby;
                }
            }
// unlock MTE_Secondary_MTES01_Polar_Orbit
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES01_Polar_Orbit;
				MissionOwner: Agency;
			}
		}
	}

    #Main_MunOrBust_04 {
        * > ContentBranches > OnSubmit {
// remove KSP2Mission_Secondary_Kerbin_OrbitCircular as it now spawns from MTE_Secondary_MTES01_Polar_Orbit
            * > ActivateMissionAction {
                @if $$TargetMissionID == KSP2Mission_Secondary_Kerbin_OrbitCircular {
                    @delete;
                }
            }
            +ActivateMissionAction {
                TargetMissionID: MTE_Secondary_Mun_OrbitInclination;
                MissionOwner: Agency;
            }
        }
	}

// lower science reward amount (originally 100)
    #KSP2Mission_Secondary_Kerbin_OrbitCircular {
		* > missionStages > _15 > MissionReward > SciencePoints {
			RewardAmount: 50.0;
		}
    }

// add KSP2Mission_Secondary_Kerbin_Satellite as a child mission of KSP2Mission_Secondary_Kerbin_OrbitEccentric
    #KSP2Mission_Secondary_Kerbin_OrbitEccentric {
        * > ContentBranches > OnSubmit {
            +ActivateMissionAction {
                TargetMissionID: KSP2Mission_Secondary_Kerbin_Satellite;
                MissionOwner: Agency;
            }
        }
    }

    #Main_Mun_OSS {
// removes KSP2Mission_Secondary_Kerbin_Satellite as it now spawns from KSP2Mission_Secondary_Kerbin_OrbitEccentric
        * > ContentBranches > OnSubmit > ActivateMissionAction {
			@if $$TargetMissionID == KSP2Mission_Secondary_Kerbin_Satellite {
				@delete;
			}
		}
    }

// adds ComSat Mun mission after Munar Signal
    #Main_Mun_01 {
        * > ContentBranches > OnSubmit {
            +ActivateMissionAction {
                TargetMissionID: MTE_Secondary_MTES05_ComSat_Mun;
                MissionOwner: Agency;
            }
        }
    }

    #Main_Minmus_BadSignal {
        * > ContentBranches > OnSubmit {
// removes Keostationnary Orbit from Bad Signal and adds Picnic at Teetering Rock instead
            * > ActivateMissionAction {
                @if $$TargetMissionID == KSP2Mission_Secondary_Kerbin_OrbitKeostationary {
                    TargetMissionID: MTE_Secondary_MTES09_Picnic_Teetering_Rock;
                }
            }
// adds I, P.A.I.G.E. as a child of Bad Signal
            +ActivateMissionAction {
                TargetMissionID: MTE_Secondary_Minmus_DestroyProbe;
                MissionOwner: Agency;
            }
        }
    }

// adds Keostationnary Orbit as a child of Lonely Satellite
    #KSP2Mission_Secondary_Kerbin_Satellite {
        * > ContentBranches > OnSubmit {
            +ActivateMissionAction {
                TargetMissionID: KSP2Mission_Secondary_Kerbin_OrbitKeostationary;
                MissionOwner: Agency;
            }
        }
    }

    #Main_Minmus_01 {
        * > ContentBranches > OnSubmit {
// adds Sightseeing as a child of Minmus Monument
            +ActivateMissionAction {
                TargetMissionID: MTE_Secondary_Kerbin_KerbinTourSOI;
                MissionOwner: Agency;
            }
        }
    }
}

// add new missions
// Dress Rehearsal
@new(MTE_Secondary_Kerbin_EVAGround)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/Kerbin_EVAGround/Name";
    description: "Missions/Secondary/Kerbin_EVAGround/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Active;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/Kerbin_EVAGround/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Kerbin;
                    propOperator: EQUAL;
                    isInput: false;
                }
				+PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselResearchLocation);
                    TestWatchedstring: Kerbin_Landed_KerbinKSC;
                    propOperator: EQUAL;
                    isInput: false;
                }
				+PropertyCondition {
					RequireCurrentValue: true;
					PropertyTypeAQN: get-property-watcher(IsActiveVesselEva);
					TestWatchedBool: true;
					propOperator: EQUAL;
					isInput: false;
				}
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 25.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_primary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterJebsJunkyard;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_annoyed;
                * > Dialogs {
                    Entries: [
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_EVAGround/Debrief01",
						ContentAddressableKey: keri_annoyed,
					},
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_EVAGround/Debrief02",
						ContentAddressableKey: keri_annoyed,
					},
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_EVAGround/Debrief03",
						ContentAddressableKey: keri_annoyed,
					},
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_primary_returned_to_missionControl;
            }
        }
    }
    MissionSaveAssetKey: "";
}

// Fly by the Mun
@new(MTE_Main_Mun_Flyby)
:missions {
    MissionGroup: "";
    name: "Missions/Primary/MTE01/Name";
    description: "Missions/Primary/MTE01/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Primary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Primary/MTE01/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Mun;
                    propOperator: EQUAL;
                    isInput: false;
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 100.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_primary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: TriumphAnimation_Mun_V1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_joy;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Brief01",
                            ContentAddressableKey: keri_joy,
                        }, {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Brief02",
                            ContentAddressableKey: keri_joy,
                        }, {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Brief03",
                            ContentAddressableKey: keri_joy,
                        }, {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Brief04",
                            ContentAddressableKey: keri_joy,
                        }, {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Brief05",
                            ContentAddressableKey: keri_joy,
                        }, {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Brief06",
                            ContentAddressableKey: keri_joy,
                        },
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_happy;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Debrief01",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Debrief02",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Primary/MTE01/Debrief03",
                            ContentAddressableKey: keri_happy,
                        },
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: TriumphAnimation_Mun_V1;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: Main_MunOrBust_04;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// Disco Party
@new(MTE_Secondary_Mun_OrbitInclination)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/Mun_OrbitInclination/Name";
    description: "Missions/Secondary/Mun_OrbitInclination/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/Mun_OrbitInclination/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Mun;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(OrbitInclination);
                    TestWatchedValue: 69;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(OrbitInclination);
                    TestWatchedValue: 71;
                    propOperator: LESSER;
                    isInput: false;
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 50.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_shocked;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/Mun_OrbitInclination/Debrief01",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/Mun_OrbitInclination/Debrief02",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/Mun_OrbitInclination/Debrief03",
                            ContentAddressableKey: keri_shocked,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
    }
    MissionSaveAssetKey: "";
}

// The Ice Spy
@new(MTE_Secondary_MTES01_Polar_Orbit)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES01/Name";
    description: "Missions/Secondary/MTES01/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES01/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Kerbin;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehiclePeriapsisAltitudePropertyWatcher);
                    TestWatchedValue: 70000.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(OrbitInclination);
                    TestWatchedValue: 85;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(OrbitInclination);
                    TestWatchedValue: 95;
                    propOperator: LESSER;
                    isInput: false;
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 30.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_neutral;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Brief01",
                            ContentAddressableKey: keri_neutral,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Brief02",
                            ContentAddressableKey: keri_neutral,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Brief03",
                            ContentAddressableKey: keri_neutral,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Brief04",
                            ContentAddressableKey: keri_neutral,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Brief05",
                            ContentAddressableKey: keri_neutral,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_happy;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Debrief01",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Debrief02",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Debrief03",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES01/Debrief04",
                            ContentAddressableKey: keri_happy,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: KSP2Mission_Secondary_Kerbin_OrbitCircular;
				MissionOwner: Agency;
			}
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES02_Polar_Probe;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// Polar Reconnaissance
@new(MTE_Secondary_MTES02_Polar_Probe)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES02/Name";
    description: "Missions/Secondary/MTES02/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES02/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Kerbin;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 80.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(CrewCount);
                    TestWatchedInt: 0;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +EventCondition {
                    EventTypeAQN: get-message(VesselLandedGroundAtRestMessage);
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 50.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_neutral;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Brief01",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Brief02",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Brief03",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Brief04",
                            ContentAddressableKey: keri_happy,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_happy;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Debrief01",
                            ContentAddressableKey: keri_joy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Debrief02",
                            ContentAddressableKey: keri_joy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Debrief03",
                            ContentAddressableKey: keri_joy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES02/Debrief04",
                            ContentAddressableKey: keri_joy,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES03_Polar_Flag;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// Operation Cold Feet
@new(MTE_Secondary_MTES03_Polar_Flag)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES03/Name";
    description: "Missions/Secondary/MTES03/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES03/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            * > actions {
                +MissionDestinationPosition {
                    celestialBodyName: Kerbin;
                    cb_Coords: {
                        x: 90.0,
                        y: 0.0,
                        z: 550.8
                    };
                }
            }
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Kerbin;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 89.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                +EventCondition {
                    EventTypeAQN: get-message(FlagPlantedMessage);
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 100.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_annoyed;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Brief01",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Brief02",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Brief03",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Brief04",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Brief05",
                            ContentAddressableKey: keri_annoyed,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_shocked;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Debrief01",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Debrief02",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Debrief03",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES03/Debrief04",
                            ContentAddressableKey: keri_shocked,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES04_Polar_Research_Station;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// The Frozen Frontier
@new(MTE_Secondary_MTES04_Polar_Research_Station)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES04/Name";
    description: "Missions/Secondary/MTES04/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES04/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Kerbin;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 80.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(CrewCount);
                    TestWatchedInt: 3;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(HasPart);
                    propOperator: EQUAL;
                    isInput: true;
                    Inputstring: "collector_0v_radial_science_general";
                }
                +EventCondition {
                    EventTypeAQN: get-message(VesselLandedGroundAtRestMessage);
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 200.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_annoyed;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Brief01",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Brief02",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Brief03",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Brief04",
                            ContentAddressableKey: keri_annoyed,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_shocked;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Debrief01",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Debrief02",
                            ContentAddressableKey: keri_shocked,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES04/Debrief03",
                            ContentAddressableKey: keri_shocked,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES06_Polar_Rover;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// Phone Home
@new(MTE_Secondary_MTES05_ComSat_Mun)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES05/Name";
    description: "Missions/Secondary/MTES05/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES05/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Mun;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(CrewCount);
                    TestWatchedInt: 0;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(HasPart);
                    propOperator: EQUAL;
                    isInput: true;
                    Inputstring: "antenna_0v_dish_ra-2";
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehiclePeriapsisAltitudePropertyWatcher);
                    TestWatchedValue: 1900000.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 250.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_teaching;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Brief01",
                            ContentAddressableKey: keri_teaching,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Brief02",
                            ContentAddressableKey: keri_teaching,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Brief03",
                            ContentAddressableKey: keri_teaching,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Brief04",
                            ContentAddressableKey: keri_teaching,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_thinking;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Debrief01",
                            ContentAddressableKey: keri_thinking,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Debrief02",
                            ContentAddressableKey: keri_thinking,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES05/Debrief03",
                            ContentAddressableKey: keri_thinking,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES07_Kerbollo;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// Whispers from the Mun
@new(MTE_Secondary_MTES07_Kerbollo)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES07/Name";
    description: "Missions/Secondary/MTES07/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES07/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            * > actions {
                +MissionDestinationPosition {
                    celestialBodyName: Mun;
                    cb_Coords: {
                        x: 34.93,
                        y: -28.48,
                        z: 200.0
                    };
                }
            }
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Mun;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(CrewCount);
                    TestWatchedInt: 3;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 34.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 36.0;
                    propOperator: LESSER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLongitudePropertyWatcher);
                    TestWatchedValue: -29.0;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLongitudePropertyWatcher);
                    TestWatchedValue: -27.0;
                    propOperator: LESSER;
                    isInput: false;
                }
                +EventCondition {
                    EventTypeAQN: get-message(VesselLandedGroundAtRestMessage);
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 400.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: TriumphAnimation_PM05;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_thinking;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Brief01",
                            ContentAddressableKey: keri_thinking,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Brief02",
                            ContentAddressableKey: keri_thinking,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Brief03",
                            ContentAddressableKey: keri_thinking,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Brief04",
                            ContentAddressableKey: keri_thinking,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Brief05",
                            ContentAddressableKey: keri_thinking,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_annoyed;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Debrief01",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Debrief02",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Debrief03",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Debrief04",
                            ContentAddressableKey: keri_annoyed,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES07/Debrief05",
                            ContentAddressableKey: keri_annoyed,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_MTES08_Munar_Gateway;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// I, P.A.I.G.E.
@new(MTE_Secondary_Minmus_DestroyProbe)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/Minmus_DestroyProbe/Name";
    description: "Missions/Secondary/Minmus_DestroyProbe/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/Minmus_DestroyProbe/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(IsDestroyedByCbCollision);
					TestWatchedBool: true;
                    propOperator: EQUAL;
                    isInput: true;
                    Inputstring: Minmus;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(CrewCount);
                    TestWatchedInt: 0;
                    propOperator: EQUAL;
                    isInput: false;
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 250.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_teaching;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/Minmus_DestroyProbe/Debrief01",
                            ContentAddressableKey: keri_teaching,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/Minmus_DestroyProbe/Debrief02",
                            ContentAddressableKey: keri_teaching,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/Minmus_DestroyProbe/Debrief03",
                            ContentAddressableKey: keri_teaching,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
    }
    MissionSaveAssetKey: "";
}


// Picnic At Teetering Rock
@new(MTE_Secondary_MTES09_Picnic_Teetering_Rock)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/MTES09/Name";
    description: "Missions/Secondary/MTES09/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/MTES09/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            * > actions {
                +MissionDestinationPosition {
                    celestialBodyName: Minmus;
                    cb_Coords: {
                        x: 26.640,
                        y: -22.800,
                        z: 5460.45
                    };
                }
            }
            +ConditionSet {
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VesselSOIPropertyWatcher);
                    TestWatchedstring: Minmus;
                    propOperator: EQUAL;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 26.60;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLatitudePropertyWatcher);
                    TestWatchedValue: 26.7;
                    propOperator: LESSER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLongitudePropertyWatcher);
                    TestWatchedValue: -22.9;
                    propOperator: GREATER;
                    isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(VehicleLongitudePropertyWatcher);
                    TestWatchedValue: -22.0;
                    propOperator: LESSER;
                    isInput: false;
                }
                +EventCondition {
                    EventTypeAQN: get-message(VesselLandedGroundAtRestMessage);
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 400.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_secondary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKSC;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Brief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_neutral;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES09/Brief01",
                            ContentAddressableKey: keri_neutral,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES09/Brief02",
                            ContentAddressableKey: keri_neutral,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES09/Brief03",
                            ContentAddressableKey: keri_neutral,
                        }
                    ];
                }
            }
        }
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_happy;
                * > Dialogs {
                    Entries: [
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES09/Debrief01",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES09/Debrief02",
                            ContentAddressableKey: keri_happy,
                        },
                        {
                            ShowsInHistory: true,
                            DialogEntryType: Text,
                            LocKey: "Missions/Secondary/MTES09/Debrief03",
                            ContentAddressableKey: keri_happy,
                        }
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_secondary;
            }
        }
    }
    MissionSaveAssetKey: "";
}

// Sightseeing
@new(MTE_Secondary_Kerbin_KerbinTourSOI)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/Kerbin_KerbinTourSOI/Name";
    description: "Missions/Secondary/Kerbin_KerbinTourSOI/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/Kerbin_KerbinTourSOI/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
				 +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(HasBeenToResearchLocation);
                    TestWatchedstring: "Kerbin_HighOrbit";
                    propOperator: EQUAL;
                    isInput: false;
                }
				+PropertyCondition {
					RequireCurrentValue: true;
					PropertyTypeAQN: get-property-watcher(HasBeenToResearchLocation);
					TestWatchedstring: "Mun_HighOrbit";
					propOperator: EQUAL;
					isInput: false;
				}
				+PropertyCondition {
					RequireCurrentValue: true;
					PropertyTypeAQN: get-property-watcher(HasBeenToResearchLocation);
					TestWatchedstring: "Minmus_HighOrbit";
					propOperator: EQUAL;
					isInput: false;
				}
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 750.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_primary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKHS;
    TriumphLoopVideoKey: reward_mission_tier1;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_neutral;
                * > Dialogs {
                    Entries: [
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_KerbinTourSOI/Debrief01",
						ContentAddressableKey: keri_neutral,
					},
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_KerbinTourSOI/Debrief02",
						ContentAddressableKey: keri_neutral,
					},
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_KerbinTourSOI/Debrief03",
						ContentAddressableKey: keri_neutral,
					},
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_primary_returned_to_missionControl;
            }
        }
        +OnSubmit {
			+ActivateMissionAction {
				TargetMissionID: MTE_Secondary_Kerbin_KerbinTourLanding;
				MissionOwner: Agency;
			}
        }
    }
    MissionSaveAssetKey: "";
}

// Landing Party
@new(MTE_Secondary_Kerbin_KerbinTourLanding)
:missions {
    MissionGroup: "";
    name: "Missions/Secondary/Kerbin_KerbinTourLanding/Name";
    description: "Missions/Secondary/Kerbin_KerbinTourLanding/Description";
    GameModeFeatureId: ExplorationMissions;
    type: Secondary;
    Owner: Agency;
    state: Inactive;
    * > missionStages {
        +_0 {
            name: Check;
            description: "";
            Objective: "Missions/Secondary/Kerbin_KerbinTourLanding/Objective";
            MissionRewardType: None;
            DisplayObjective: true;
            +ConditionSet {
				+PropertyCondition {
					RequireCurrentValue: true;
					PropertyTypeAQN: get-property-watcher(HasBeenToResearchLocation);
					TestWatchedstring: Mun_Landed;
					propOperator: EQUAL;
					isInput: false;
				}
				+PropertyCondition {
					RequireCurrentValue: true;
					PropertyTypeAQN: get-property-watcher(HasBeenToResearchLocation);
					TestWatchedstring: Minmus_Landed;
					propOperator: EQUAL;
					isInput: false;
                }
                +PropertyCondition {
                    RequireCurrentValue: true;
                    PropertyTypeAQN: get-property-watcher(HasBeenToResearchLocation);
                    TestWatchedstring: Kerbin_Landed;
                    propOperator: EQUAL;
                    isInput: false;
                }
                ConditionMode: AND;
            }
        }
        +_1 {
            name: "Mission Complete";
            description: "";
            Objective: "";
            * > MissionReward {
                +SciencePoints {
                    RewardAmount: 750.0;
                }
            }
            * > actions {
                +MissionResolutionAction {
                    MissionResolution: Complete;
                    StageEvent: Play_mission_alert_primary;
                }
            }
            IgnoreExceptionBranches: true;
        }
    }
    currentStageIndex: 0;
    Hidden: false;
    MissionGranterKey: MissionGranterKHS;
    TriumphLoopVideoKey: TriumphAnimation_PM05;
    VisibleRewards: true;
    pendingCompletionTest: false;
    maxStageID: 2;
    uiDisplayType: Default;
    * > ContentBranches {
		+Debrief {
            +MissionCharacterDialogAction {
                CharacterNameLocKey: "Missions/CharacterName/Keri";
                CharacterIconKey: keri_thinking;
                * > Dialogs {
                    Entries: [
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_KerbinTourLanding/Debrief01",
						ContentAddressableKey: keri_thinking,
					},
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_KerbinTourLanding/Debrief02",
						ContentAddressableKey: keri_thinking,
					},
					{
						ShowsInHistory: true,
						DialogEntryType: Text,
						LocKey: "Missions/Secondary/Kerbin_KerbinTourLanding/Debrief03",
						ContentAddressableKey: keri_thinking,
					},
                    ];
                }
                EventTypeOnClosed: get-message(SpawnTriumphWindow);
                StageEvent: Play_mission_alert_primary_returned_to_missionControl;
            }
        }
    }
    MissionSaveAssetKey: "";
}
